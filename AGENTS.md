# AGENTS.md
# Project: Interactive Convex Lens Imaging H5 (凸透镜成像互动网页)
# Target Audience: 初中生（中学物理课程：光的折射与成像）
# Developer Agent: Codex
# Supervisor: Ruiyang Lu
# File Flow: index_step1.html → index_step2.html → index_final.html

---

## 🌍 Overview
本项目旨在制作一个能让学生**拖动滑块、观察成像变化、完成小任务**的教学网页。
整个开发过程分为三步进行，每一步都在你（Ruiyang）发出具体指令后才开始。
  
Codex 只在用户明确说出  
> “开始 Step 1” / “开始 Step 2” / “开始 Step 3”  
时才执行对应部分。

在没有接到命令前，Codex 只应阅读本文件并等待指令。  

---

# 🧩 Step 1 — 页面框架与视觉结构
**Trigger:** When the user says “开始 Step 1” or “Please execute Step 1”.

---

## 🎯 Goal
搭建整个网页的基本框架（HTML + CSS），确保布局合理、样式直观，但**不包含任何 JS 逻辑**。

### ✅ 输出要求
- 输出完整的单文件 HTML：`index_step1.html`
- 页面中须包含以下区域：
  1. **顶部标题栏**：显示“凸透镜成像实验”，字体居中。
  2. **左侧控制区**：
     - 三个滑块：物距(u)、焦距(f)、物高(hₒ)
     - 每个滑块旁边显示当前数值。
     - 一个“显示光线”开关按钮。
  3. **中央画布区**：
     - 预留 `<div id="canvas">` 或 `<svg>` 区域用于后续绘制光线。
     - 默认显示一幅占位图（例如“（此处显示凸透镜示意图）”）。
  4. **右侧信息区**：
     - 准备三个空白标签显示：
       - 像距(v)
       - 放大率(m)
       - 成像性质（实像/虚像、倒立/正立、放大/缩小）
  5. **底部页脚**：显示“© 2025 教育科技实验演示”。

### 🎨 样式规范
- 页面采用浅色背景（#f9f9f9），配深蓝色边框线。
- 各区域布局：使用 CSS Grid 或 Flex 布局。
- 字体偏大（建议 18–20px），适合投影教学。
- 控件区与结果区用白色卡片背景 + 阴影。
- 所有文字为中文。

### ⚙️ 技术说明
- 不引入外部库（不使用 CDN）。
- 所有样式内嵌在 `<style>` 标签中。
- 文件结构应简洁、注释清晰。
- Step 1 完成后 Codex **必须停止**，等待“开始 Step 2”命令。

---

# 🔬 Step 2 — 交互逻辑与物理计算
**Trigger:** When the user says “开始 Step 2”.

---

## 🎯 Goal
在 Step 1 的基础上，加入**JS 交互逻辑与实时光线绘制**功能，实现凸透镜成像的动态演示。

### ✅ 输出要求
- 输出文件名：`index_step2.html`
- 网页应能实时响应滑块变化，自动更新光线与结果。
- 用原生 JS 实现以下功能：
  1. **三项可调输入：**
     - 物距 `u`（范围 5–30 cm）
     - 焦距 `f`（范围 5–15 cm）
     - 物高 `hₒ`（范围 1–5 cm）
  2. **计算规则：**
     - 成像公式：  
       `1/f = 1/u + 1/v`  
       → `v = (f * u) / (u - f)`
     - 放大率：  
       `m = v / u`
     - 像高：  
       `hᵢ = m * hₒ`
  3. **判定像的性质：**
     - v > 0 → 实像；v < 0 → 虚像  
     - m > 0 → 正立；m < 0 → 倒立  
     - 若 |u - f| < 0.2 → 输出提示“接近平行光，不成像”。
  4. **画面绘制：**
     - 使用 `<svg>` 实时绘制：
       - 主光轴（水平线）
       - 透镜（竖直椭圆）
       - 物体箭头（左侧）
       - 像箭头（右侧或左侧，依据结果）
       - 三条主要光线（过光心 / 过焦点 / 平行主轴）
  5. **动态更新：**
     - 拖动滑块时自动重绘画面。
     - 在信息区实时显示：
       ```
       物距 u = __ cm
       像距 v = __ cm
       放大率 m = __
       像的性质：实像/虚像，倒立/正立，放大/缩小
       ```

### 🧠 编码要求
- 不使用外部框架。
- 所有逻辑封装在一个函数 `updateScene()`。
- 必须包含关键注释，解释公式来源与绘制逻辑。
- 变量名英文化（u, f, v, m, ho, hi），注释用中文。
- 每次绘制前清空旧线条，避免叠影。
- Step 2 完成后 Codex **暂停执行**，等待“开始 Step 3”命令。

---

# 🧪 Step 3 — 教学功能与交互任务
**Trigger:** When the user says “开始 Step 3”.

---

## 🎯 Goal
将演示网页升级为可用于课堂教学的**小型虚拟实验平台**。  
在现有交互基础上加入任务、总结、测验等教学模块。

### ✅ 输出要求
- 输出文件名：`index_final.html`
- 必须包含以下模块：

#### 1️⃣ 模式切换按钮
- “探索模式”：自由拖动滑块。
- “规律总结”：系统自动扫描不同物距，生成表格。
- “挑战模式”：随机出题，如：
  > “请调节物距，使像为倒立放大的实像。”
- “测验模式”：3–5 题判断或选择题（即时反馈）。

#### 2️⃣ 规律总结表格
| 物距区间 | 成像类型 | 像距范围 | 放大率 | 像的特点 |
|-----------|-----------|-----------|----------|-----------|
| u > 2f | 实像、倒立、缩小 | f < v < 2f | 0 < m < 1 | ... |

#### 3️⃣ 成功判定逻辑
- 当成像性质与题目条件匹配，显示“✅ 完成！”
- 错误时弹出“❌ 再试试～”

#### 4️⃣ 数据存储
- 使用 `localStorage` 保存：
  - 上次物距、焦距、物高
  - 测验答题记录
  - 模式切换状态

#### 5️⃣ 可选教师模式
- 按钮启用后显示：
  - 焦点标记 F、2F
  - 网格背景
  - 误差容差范围线

#### 6️⃣ 提示与文案
- 语气友好、贴近学生：
  - “拖动滑块看看会发生什么～”
  - “是不是像变大了？”
  - “物体太靠近焦点了，会怎样呢？”
- 颜色区分实像（蓝）与虚像（橙）。

#### 7️⃣ 导出功能（可选）
- 一键生成当前成像截图或总结表，用于提交作业。

### 💻 技术要求
- 仍为单文件 HTML。
- 内嵌全部逻辑（HTML + CSS + JS）。
- 可使用 Canvas 或 SVG。
- 保证在 Chrome / Edge / 移动端浏览器均可运行。
- 保留 Step 2 的全部功能。

---

# 🧾 Project Summary

| Step | 内容重点 | 输出文件 | 结果 |
|------|-----------|-----------|-----------|
| Step 1 | 页面框架与样式 | index_step1.html | 静态页面可视化 |
| Step 2 | 光线绘制与交互 | index_step2.html | 成像演示可操作 |
| Step 3 | 教学与任务系统 | index_final.html | 虚拟实验课完整版 |

---

# 🚦 Execution Rules for Codex
1. 在用户明确说出“开始 Step X”之前，不执行任何生成。
2. 每步完成后自动停止，等待下一步指令。
3. 所有代码需可单独运行。
4. 若检测到错误或变量无效，Codex 应给出修复提示并重新生成。
5. 每一步的输出需完整覆盖上一步内容，不依赖外部文件。

---
